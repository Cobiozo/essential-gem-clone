

# Plan: Osobna Strona WiadomoÅ›ci w Stylu WhatsApp

## Wizualizacja proponowanego rozwiÄ…zania

### Layout peÅ‚noekranowy (widok desktop)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ¿ PURE LIFE                    ğŸ””  ğŸŒPL  â—  [Akademia]  [Strona gÅ‚Ã³wna]  [â†’ Wyloguj siÄ™]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                   â”‚                                                                 â”‚
â”‚  â† PowrÃ³t do pulpitu              â”‚                       Partnerzy                              ğŸ” â”‚
â”‚                                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                                                 â”‚
â”‚  â”‚ ğŸ” Szukaj rozmÃ³w...         â”‚  â”‚                                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     DK   Dawid Kowalczyk                        Dzisiaj 07:16  â”‚
â”‚                                   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  KANAÅY                           â”‚          â”‚  CzeÅ›Ä‡! Jak mogÄ™ pomÃ³c?              â”‚               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                   â”‚          ğŸ‘ 1                                                   â”‚
â”‚  â— Wszyscy               â€¢        â”‚                                                                 â”‚
â”‚  â— Partnerzy            â† â—2      â”‚                                                                 â”‚
â”‚  â— SpecjaliÅ›ci                    â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â— Klienci                        â”‚               â”‚  DziÄ™ki, wszystko jasne!             â”‚  Ty      â”‚
â”‚                                   â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚                                                    Dzisiaj 07:20â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚  OSTATNIE ROZMOWY                 â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚  ğŸ‘¤ Anna Nowak                    â”‚                                                                 â”‚
â”‚     DziÄ™ki za info!   â€¢ 2h temu   â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚  ğŸ‘¤ Jan Kowalski                  â”‚                                                                 â”‚
â”‚     OK, rozumiem      â€¢ wczoraj   â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚                                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                   â”‚                                                                 â”‚
â”‚                                   â”‚  ğŸ“  ğŸ˜Š  ğŸ¤   Wpisz wiadomoÅ›Ä‡...                        âœˆ       â”‚
â”‚                                   â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Layout mobilny (responsive)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† WiadomoÅ›ci         ğŸ”   â”‚          â”‚  â† Partnerzy          ğŸ”   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚          â”‚                            â”‚
â”‚  ğŸ” Szukaj rozmÃ³w...       â”‚          â”‚  DK  Dawid Kowalczyk       â”‚
â”‚                            â”‚   TAP    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  KANAÅY                    â”‚  â”€â”€â”€â†’    â”‚      â”‚ CzeÅ›Ä‡! Jak   â”‚      â”‚
â”‚  â— Wszyscy            â€¢    â”‚          â”‚      â”‚ mogÄ™ pomÃ³c?  â”‚      â”‚
â”‚  â— Partnerzy         â—2    â”‚          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â— SpecjaliÅ›ci             â”‚          â”‚      ğŸ‘ 1                  â”‚
â”‚  â— Klienci                 â”‚          â”‚                            â”‚
â”‚                            â”‚          â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Ty   â”‚
â”‚  OSTATNIE ROZMOWY          â”‚          â”‚      â”‚ DziÄ™ki!      â”‚      â”‚
â”‚                            â”‚          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  ğŸ‘¤ Anna Nowak             â”‚          â”‚                            â”‚
â”‚     DziÄ™ki za info!        â”‚          â”‚                            â”‚
â”‚                            â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¤ Jan Kowalski           â”‚          â”‚ ğŸ“ ğŸ˜Š ğŸ¤ Wpisz...     âœˆ    â”‚
â”‚     OK, rozumiem           â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     LISTA                                      CZAT
```

---

## Zakres zmian

### 1. Nowa strona: `/messages` (MessagesPage.tsx)

PeÅ‚noekranowa strona komunikatora z:
- **Header**: Prosty pasek z przyciskiem "PowrÃ³t do pulpitu" i tytuÅ‚em "WiadomoÅ›ci"
- **Sidebar (320px)**: Lista kanaÅ‚Ã³w + ostatnie rozmowy z podglÄ…dem ostatniej wiadomoÅ›ci
- **Chat window**: Okno rozmowy z wybranym kanaÅ‚em
- **ResponsywnoÅ›Ä‡**: Na mobile - przeÅ‚Ä…czanie miÄ™dzy widokiem listy a czatem

### 2. Struktura nowej strony

```typescript
// src/pages/MessagesPage.tsx

const MessagesPage = () => {
  const navigate = useNavigate();
  const [mobileView, setMobileView] = useState<'list' | 'chat'>('list');
  
  const {
    channels,
    selectedChannel,
    messages,
    loading,
    selectChannel,
    sendMessage,
  } = useUnifiedChat({ enableRealtime: true });

  return (
    <div className="h-screen flex flex-col bg-background">
      {/* Mini header - tylko link powrotu */}
      <header className="h-14 border-b flex items-center px-4 bg-background/95 backdrop-blur">
        <Button variant="ghost" onClick={() => navigate('/dashboard')}>
          <ArrowLeft className="h-4 w-4 mr-2" />
          PowrÃ³t do pulpitu
        </Button>
        <h1 className="ml-4 font-semibold">WiadomoÅ›ci</h1>
      </header>
      
      {/* Main content - 2 columns on desktop, switchable on mobile */}
      <div className="flex-1 flex overflow-hidden">
        {/* Sidebar - kanaÅ‚y i rozmowy */}
        <MessagesSidebar 
          channels={channels}
          selectedChannel={selectedChannel}
          onSelectChannel={(id) => {
            selectChannel(id);
            setMobileView('chat'); // Switch to chat on mobile
          }}
          className={cn(
            'w-80 border-r',
            // Mobile: show only when mobileView === 'list'
            'max-md:absolute max-md:inset-0 max-md:w-full max-md:z-10',
            mobileView !== 'list' && 'max-md:hidden'
          )}
        />
        
        {/* Chat window */}
        <div className={cn(
          'flex-1 flex flex-col',
          mobileView !== 'chat' && 'max-md:hidden'
        )}>
          {selectedChannel ? (
            <FullChatWindow
              channel={selectedChannel}
              messages={messages}
              loading={loading}
              onSend={sendMessage}
              onBack={() => setMobileView('list')} // Mobile back button
            />
          ) : (
            <EmptyState />
          )}
        </div>
      </div>
    </div>
  );
};
```

### 3. Rozszerzony sidebar z podglÄ…dem ostatniej wiadomoÅ›ci

```typescript
// KaÅ¼dy kanaÅ‚ pokazuje:
// - NazwÄ™ kanaÅ‚u/osoby
// - PodglÄ…d ostatniej wiadomoÅ›ci (skrÃ³cony)
// - Czas ostatniej wiadomoÅ›ci
// - Badge z liczbÄ… nieprzeczytanych

<div className="flex items-center gap-3 p-3 hover:bg-muted/50 cursor-pointer">
  <Avatar className="h-12 w-12">
    <AvatarFallback>PA</AvatarFallback>
  </Avatar>
  <div className="flex-1 min-w-0">
    <div className="flex justify-between items-center">
      <span className="font-medium">Partnerzy</span>
      <span className="text-xs text-muted-foreground">07:16</span>
    </div>
    <p className="text-sm text-muted-foreground truncate">
      Dawid: CzeÅ›Ä‡! Jak mogÄ™ pomÃ³c?
    </p>
  </div>
  {unreadCount > 0 && (
    <Badge variant="destructive">{unreadCount}</Badge>
  )}
</div>
```

### 4. Aktualizacja nawigacji w DashboardSidebar

Zmiana Å›cieÅ¼ki dla "Czat" z `/my-account?tab=communication` na `/messages`:

```typescript
// src/components/dashboard/DashboardSidebar.tsx
{ 
  id: 'chat', 
  icon: MessageSquare, 
  labelKey: 'dashboard.menu.chat', 
  path: '/messages',  // â† ZMIANA: osobna strona zamiast zakÅ‚adki
},
```

### 5. Nowa trasa w App.tsx

```typescript
// src/App.tsx
const MessagesPage = lazyWithRetry(() => import("./pages/MessagesPage"));

// W Routes:
<Route path="/messages" element={<MessagesPage />} />
```

---

## Struktura plikÃ³w

```text
src/pages/
â””â”€â”€ MessagesPage.tsx              # NOWY: PeÅ‚noekranowa strona komunikatora

src/components/messages/          # NOWY folder
â”œâ”€â”€ MessagesSidebar.tsx           # Rozszerzony sidebar z podglÄ…dami
â”œâ”€â”€ MessagesHeader.tsx            # Mini header z powrotem
â”œâ”€â”€ FullChatWindow.tsx            # PeÅ‚noekranowe okno czatu
â”œâ”€â”€ ChannelListItem.tsx           # Element listy z podglÄ…dem
â””â”€â”€ MobileBackButton.tsx          # Przycisk powrotu na mobile
```

---

## Sekcja techniczna

### Komponenty do utworzenia:

| Komponent | Opis |
|-----------|------|
| `MessagesPage.tsx` | GÅ‚Ã³wna strona `/messages` z peÅ‚noekranowym layoutem |
| `MessagesSidebar.tsx` | Sidebar z kanaÅ‚ami i podglÄ…dem ostatnich wiadomoÅ›ci |
| `FullChatWindow.tsx` | Okno czatu z przyciskiem powrotu na mobile |
| `ChannelListItem.tsx` | Element listy kanaÅ‚u z avatar, podglÄ…dem i czasem |

### Modyfikacje istniejÄ…cych plikÃ³w:

| Plik | Zmiana |
|------|--------|
| `src/App.tsx` | Dodanie trasy `/messages` |
| `src/components/dashboard/DashboardSidebar.tsx` | Zmiana path dla "Czat" na `/messages` |

### ResponsywnoÅ›Ä‡:

- **Desktop (>768px)**: 2 kolumny obok siebie (sidebar 320px + chat flex-1)
- **Mobile (<768px)**: PrzeÅ‚Ä…czanie widokÃ³w list â†” chat
- **Animacje**: Slide transition przy zmianie widoku na mobile

### Integracja z istniejÄ…cym kodem:

- Wykorzystanie `useUnifiedChat` hook bez zmian
- Wykorzystanie istniejÄ…cych komponentÃ³w: `MessageBubble`, `MessageInput`
- Real-time i powiadomienia dziaÅ‚ajÄ… bez zmian
- `CommunicationCenter` w "Moje konto" pozostaje jako fallback

---

## PorÃ³wnanie z obecnym rozwiÄ…zaniem

| Aspekt | Obecne (zakÅ‚adka) | Nowe (osobna strona) |
|--------|-------------------|---------------------|
| Lokalizacja | `/my-account?tab=communication` | `/messages` |
| WysokoÅ›Ä‡ | 600px (widget) | 100vh (peÅ‚ny ekran) |
| Sidebar | Minimalistyczny | Rozszerzony z podglÄ…dem wiadomoÅ›ci |
| Mobile | Brak dedykowanego UX | PrzeÅ‚Ä…czanie list/chat |
| Nawigacja | Przez "Moje konto" | BezpoÅ›redni link w sidebar |
| Styl | Widget osadzony | Samodzielna aplikacja jak WhatsApp |

---

## Zachowana funkcjonalnoÅ›Ä‡

- âœ… Role-based channels (Admin, Partner, Specjalista, Klient)
- âœ… Hierarchia uprawnieÅ„ (kto moÅ¼e do kogo pisaÄ‡)
- âœ… Real-time aktualizacje
- âœ… Powiadomienia z `user_notifications`
- âœ… IstniejÄ…cy `useUnifiedChat` hook
- âœ… Stary `CommunicationCenter` pozostaje (backward compatibility)

